from hypothesis import given
from hypothesis.strategies import composite
from hypothesis.strategies import floats
from hypothesis.strategies import lists

from winding_number import Point
from winding_number import is_left
from winding_number import point_in_polygon


def test_is_left_upward_left():
    l0 = Point(x=1, y=1)
    l1 = Point(x=2, y=3)
    p = Point(x=1.5, y=4)
    assert is_left(p, l0, l1) > 0


def test_is_left_upward_right():
    l0 = Point(x=1, y=1)
    l1 = Point(x=2, y=3)
    p = Point(x=1.5, y=1.25)
    assert is_left(p, l0, l1) < 0


def test_is_left_upward_on():
    l0 = Point(x=1, y=1)
    l1 = Point(x=2, y=4)
    p = Point(x=1.5, y=2.5)
    assert is_left(p, l0, l1) == 0


def test_is_left_downward_right():
    l0 = Point(x=2, y=3)
    l1 = Point(x=1, y=1)
    p = Point(x=1.5, y=4)
    assert is_left(p, l0, l1) < 0


def test_is_left_downward_left():
    l0 = Point(x=2, y=3)
    l1 = Point(x=1, y=1)
    p = Point(x=1.5, y=1.25)
    assert is_left(p, l0, l1) > 0


def test_is_left_downward_on():
    l0 = Point(x=2, y=4)
    l1 = Point(x=1, y=1)
    p = Point(x=1.5, y=2.5)
    assert is_left(p, l0, l1) == 0


def test_is_left_horizontal_left():
    l0 = Point(x=2, y=4)
    l1 = Point(x=10, y=4)
    p = Point(x=-1, y=6)
    assert is_left(p, l0, l1) > 0


def test_is_left_horizontal_right():
    l0 = Point(x=2, y=4)
    l1 = Point(x=10, y=4)
    p = Point(x=-1, y=-3)
    assert is_left(p, l0, l1) < 0


@composite
def random_polygon(draw, min_value=0.0, max_value=0.0):
    float_strategy = floats(
        min_value=min_value,
        max_value=max_value,
        allow_nan=False,
        allow_infinity=False,
    )
    xs = draw(
        lists(
            float_strategy,
            min_size=1,
            max_size=50,
            unique=True))
    ys = draw(
        lists(
            float_strategy,
            min_size=1,
            max_size=50))
    pts = [Point(x=x, y=y) for (x, y) in zip(xs, ys)]
    # duplicate last point so the polygon is closed.
    return pts + [pts[0]]


@given(
    random_polygon(min_value=0.0, max_value=1.0),
    floats(allow_nan=False, allow_infinity=False)
)
def test_point_outside_polygon_bounding_box(polygon, value):
    assert not point_in_polygon(Point(x=value, y=1.1), polygon)
    assert not point_in_polygon(Point(x=value, y=-0.1), polygon)
    assert not point_in_polygon(Point(x=1.1, y=value), polygon)
    assert not point_in_polygon(Point(x=-0.1, y=value), polygon)


def test_unit_square():
    polygon = [
        Point(x=0, y=0),
        Point(x=1, y=0),
        Point(x=1, y=1),
        Point(x=0, y=1),
        Point(x=0, y=0),
    ]
    assert point_in_polygon(Point(x=0.5, y=0.5), polygon)
    assert not point_in_polygon(Point(x=-0.5, y=0.5), polygon)


def test_convex_polygon():
    coords = [
        [249.15073494468575, 488.7324531515856],
        [212.15383231189944, 395.35494075774545],
        [209.06955767803947, 288.4049500764051],
        [403.5510950824299, 109.68712300659101],
        [431.7693416274244, 130.13783480456675],
        [434.7493560946515, 173.11003655801449],
        [352.1996595278678, 422.81739758979796],
        [321.00477970452636, 452.52297223804726],
    ]
    polygon = [Point(x=x, y=y) for (x, y) in coords]

    # both examples are in the bounding box of the convex polygon
    assert point_in_polygon(Point(x=321, y=298), polygon)
    assert not point_in_polygon(Point(x=400, y=487), polygon)


# an example of a complicated non-convex polygon,
# a "comb" with dozens of teeth
comb_coords = [
    [-0.114570, -0.038880],
    [-0.176520, 1.060780],
    [-0.228012, 1.867800],
    [-0.147138, 2.871530],
    [-0.219042, 3.807210],
    [-0.158886, 4.797970],
    [-0.160032, 5.809940],
    [-0.183732, 7.008640],
    [-0.138594, 8.103320],
    [-0.203880, 8.828820],
    [-0.193050, 9.875480],
    [0.874558, 10.146400],
    [1.187800, 8.894890],
    [0.886660, 7.800430],
    [0.773734, 6.836560],
    [0.848872, 5.893430],
    [0.946120, 4.830680],
    [0.773482, 3.914500],
    [1.250080, 3.180780],
    [0.817762, 2.195420],
    [1.204660, 0.800830],
    [1.886530, 0.794878],
    [1.796890, 1.841170],
    [1.798450, 2.817870],
    [1.896010, 3.934540],
    [1.936340, 4.813630],
    [1.824100, 6.226440],
    [2.176160, 6.768340],
    [1.779010, 8.207240],
    [1.845850, 8.760330],
    [1.806550, 9.819220],
    [2.881640, 9.794330],
    [2.830820, 8.879520],
    [3.018660, 7.841890],
    [2.852370, 6.889360],
    [3.134700, 5.873010],
    [2.779660, 4.783230],
    [2.855410, 3.762190],
    [2.833810, 2.855530],
    [3.217260, 1.836850],
    [2.812520, 0.847762],
    [4.268500, 0.788866],
    [3.959800, 1.817780],
    [3.968500, 2.862750],
    [3.894020, 3.872890],
    [3.776540, 4.878520],
    [3.871770, 5.878670],
    [3.992200, 6.806270],
    [3.797840, 7.764190],
    [3.765340, 8.809630],
    [3.796860, 9.766180],
    [4.879250, 10.099000],
    [4.850910, 8.856400],
    [4.884130, 8.031500],
    [5.046800, 6.857500],
    [4.818500, 5.996760],
    [4.834470, 4.885020],
    [5.267000, 3.764740],
    [4.976840, 2.867990],
    [4.880280, 1.832800],
    [4.777330, 1.220620],
    [5.815920, 0.798130],
    [5.829180, 1.975040],
    [5.855370, 2.967300],
    [5.889120, 3.964720],
    [5.787550, 5.062940],
    [5.892660, 5.891430],
    [5.886540, 7.090540],
    [5.829870, 7.882720],
    [5.844860, 9.171840],
    [6.000120, 9.802240],
    [7.153060, 10.092800],
    [6.872040, 8.760580],
    [6.799650, 8.276300],
    [6.829260, 7.256680],
    [6.868060, 5.824640],
    [6.826040, 4.818940],
    [6.784320, 4.282300],
    [6.841530, 2.846350],
    [7.026940, 1.850870],
    [6.858200, 0.768526],
    [7.841160, 1.096000],
    [7.835680, 1.850240],
    [7.768990, 2.773940],
    [7.858670, 3.878190],
    [8.088080, 4.849830],
    [7.825930, 5.953680],
    [8.226860, 6.819810],
    [7.886840, 8.200100],
    [7.894570, 8.790040],
    [7.815720, 9.781730],
    [9.291120, 9.892280],
    [9.006840, 8.871410],
    [8.863820, 7.807450],
    [8.767690, 6.788090],
    [9.123660, 5.791860],
    [9.050700, 4.849500],
    [9.166800, 4.168480],
    [8.893230, 2.872870],
    [8.781860, 1.852500],
    [8.766090, 0.815776],
    [9.892800, 0.896182],
    [9.885300, 1.876680],
    [9.861910, 2.833290],
    [9.837570, 3.889280],
    [9.786160, 4.890640],
    [9.846840, 5.825640],
    [9.774150, 6.800940],
    [9.851520, 7.860930],
    [10.216100, 8.803960],
    [9.769430, 10.207300],
    [11.027500, 9.857140],
    [10.826200, 8.885540],
    [10.875400, 7.888060],
    [10.943800, 6.851640],
    [11.062000, 5.890470],
    [10.854000, 4.822060],
    [10.779700, 4.174720],
    [10.783700, 2.799980],
    [10.838400, 2.161460],
    [10.788700, 0.778090],
    [12.113500, 0.800200],
    [11.867400, 1.763060],
    [12.262100, 2.813530],
    [11.842200, 3.892580],
    [11.771400, 4.808650],
    [11.831800, 5.790940],
    [11.779500, 6.868770],
    [12.015600, 8.197820],
    [11.800000, 8.795820],
    [12.261700, 10.042100],
    [12.838300, 9.814600],
    [12.877300, 8.783990],
    [12.787600, 7.860900],
    [12.771700, 6.776210],
    [12.871500, 5.825890],
    [12.801700, 5.296160],
    [12.762900, 3.851900],
    [12.803700, 2.810200],
    [13.003000, 1.775600],
    [12.829500, 0.831808],
    [13.786300, 0.888598],
    [13.840200, 1.824110],
    [13.792600, 3.232620],
    [13.907100, 3.862180],
    [13.840800, 5.169620],
    [13.807400, 5.900940],
    [14.051800, 6.833340],
    [13.818900, 8.121440],
    [13.844200, 8.867700],
    [13.884500, 10.184000],
    [14.788100, 9.854640],
    [14.792900, 9.107700],
    [14.785800, 7.800590],
    [14.760200, 6.786240],
    [15.221500, 6.282180],
    [14.823500, 4.894280],
    [14.788200, 3.937780],
    [14.783300, 2.820910],
    [14.823200, 2.081900],
    [15.199400, 0.813250],
    [15.932200, 1.254460],
    [15.875100, 1.867520],
    [15.891300, 2.895400],
    [15.858800, 3.890670],
    [15.809300, 4.784570],
    [16.158600, 5.848560],
    [15.839000, 6.889960],
    [16.285800, 7.782090],
    [15.874500, 8.796920],
    [15.823100, 9.875390],
    [16.816000, 10.253100],
    [16.874600, 8.859440],
    [16.841000, 7.786750],
    [17.168900, 6.807300],
    [16.766900, 5.762350],
    [16.855400, 5.103080],
    [16.808300, 3.889640],
    [17.111100, 2.886000],
    [16.818500, 1.837960],
    [16.833500, 0.790894],
    [17.868400, 1.234960],
    [18.175900, 1.992140],
    [17.859000, 2.803180],
    [17.774800, 4.148200],
    [17.828800, 5.066000],
    [17.863200, 5.972580],
    [17.958200, 6.789710],
    [17.877700, 7.856940],
    [17.776100, 8.769790],
    [17.903000, 9.864560],
    [18.777600, 9.868980],
    [19.298900, 9.076800],
    [18.983200, 7.904600],
    [19.288200, 6.780130],
    [18.846100, 6.281400],
    [18.890000, 5.175740],
    [19.162200, 3.821140],
    [18.869700, 3.076800],
    [19.010100, 1.809450],
    [18.800800, 0.875680],
    [19.774300, 0.782926],
    [20.033300, 1.833240],
    [20.160800, 2.860100],
    [19.767600, 3.776800],
    [19.801400, 4.764520],
    [19.871000, 6.060240],
    [19.761200, 6.812580],
    [19.855900, 7.856680],
    [20.207700, 8.808040],
    [19.869900, 10.116300],
    [21.139700, 9.844800],
    [20.879900, 8.825840],
    [20.886400, 8.251220],
    [20.877300, 6.802720],
    [20.834100, 6.111180],
    [20.876000, 4.833970],
    [20.769200, 3.831760],
    [20.857300, 3.269760],
    [21.243900, 1.873050],
    [20.865000, 0.859270],
    [21.892300, 0.868732],
    [22.281000, 1.810150],
    [21.908600, 2.845270],
    [21.829400, 3.823900],
    [22.031200, 5.055860],
    [21.801000, 5.864100],
    [21.761500, 6.921580],
    [21.877900, 7.851230],
    [21.878300, 8.786770],
    [21.835000, 9.852370],
    [22.809000, 10.294600],
    [22.960900, 8.861060],
    [22.803700, 7.768830],
    [22.854300, 6.772000],
    [22.763500, 5.839530],
    [23.106700, 4.817540],
    [22.974800, 3.793120],
    [22.789300, 3.142740],
    [23.206900, 2.038460],
    [22.839300, 0.859942],
    [24.091900, 0.878884],
    [23.850100, 1.892410],
    [23.760700, 2.892640],
    [23.841700, 3.802840],
    [23.834000, 4.874300],
    [23.893000, 6.042960],
    [23.863500, 6.895300],
    [24.167100, 7.802440],
    [23.800900, 8.837210],
    [23.882800, 10.213700],
    [24.816800, 9.874990],
    [25.095400, 8.881690],
    [24.802300, 7.844360],
    [24.835600, 6.840840],
    [24.778900, 6.127140],
    [25.014200, 4.828390],
    [25.175000, 3.833450],
    [24.770700, 2.823370],
    [24.769800, 1.835770],
    [24.809000, 0.813406],
    [25.797400, 0.856852],
    [26.022900, 1.778590],
    [25.843000, 3.231600],
    [25.823500, 3.853800],
    [25.812600, 4.811830],
    [25.817800, 5.815600],
    [25.791800, 6.806100],
    [25.889000, 7.890480],
    [25.798800, 9.154320],
    [25.838700, 9.867780],
    [26.764600, 9.847560],
    [26.824500, 8.890250],
    [27.163000, 7.790740],
    [26.829600, 6.790300],
    [26.823000, 5.953560],
    [26.776800, 4.776020],
    [27.154000, 4.044880],
    [26.791200, 2.780830],
    [26.820000, 1.887800],
    [26.952500, 0.774628],
    [27.823000, 0.788920],
    [27.868400, 1.881310],
    [27.793500, 2.760600],
    [27.855100, 3.806310],
    [27.859800, 4.815310],
    [27.793500, 5.844900],
    [27.893900, 7.052620],
    [28.006300, 7.881780],
    [27.882700, 9.217740],
    [27.870700, 9.853380],
    [28.843900, 9.839660],
    [28.844400, 9.073980],
    [28.783500, 7.868990],
    [28.889600, 6.788480],
    [28.821200, 5.809490],
    [28.890600, 4.871200],
    [29.189900, 3.870860],
    [29.171100, 2.788630],
    [28.760800, 1.774040],
    [28.776800, 0.851014],
    [29.832400, 0.789274],
    [30.269200, 1.847330],
    [29.794100, 2.786990],
    [30.018500, 3.792860],
    [29.843100, 4.937060],
    [29.857900, 5.829290],
    [29.786900, 6.774960],
    [30.040700, 7.822400],
    [30.231400, 8.802080],
    [30.015300, 9.777040],
    [30.817400, 9.771700],
    [30.855000, 8.816970],
    [30.832800, 7.772970],
    [30.828800, 6.826170],
    [30.860100, 5.789840],
    [30.873100, 4.810160],
    [31.003000, 3.801950],
    [30.767300, 2.808880],
    [30.828600, 1.894400],
    [30.796700, 0.766960],
    [31.836100, 0.898240],
    [31.800600, 1.854700],
    [31.833700, 2.821780],
    [31.936200, 3.824810],
    [31.821500, 4.868110],
    [31.854000, 5.893170],
    [32.135300, 6.954640],
    [31.823500, 7.832220],
    [31.856100, 8.806520],
    [31.863700, 10.180300],
    [32.895100, 9.855840],
    [32.852900, 8.819540],
    [32.785100, 7.797540],
    [32.844800, 6.886420],
    [33.020600, 5.873570],
    [32.776900, 4.779260],
    [32.805900, 4.295740],
    [32.886200, 2.809680],
    [32.803400, 1.785300],
    [32.969200, 0.829210],
    [33.891400, 0.817690],
    [33.874600, 1.771810],
    [33.871700, 2.902320],
    [33.884400, 3.798400],
    [33.993200, 4.895730],
    [34.050800, 6.268200],
    [34.150000, 7.011520],
    [33.866800, 7.775350],
    [33.767500, 8.963280],
    [33.794300, 9.817640],
    [34.767600, 9.816720],
    [34.800900, 8.869840],
    [34.825900, 7.868530],
    [34.890500, 6.826170],
    [35.124900, 5.771750],
    [34.867600, 4.785720],
    [34.798100, 3.800830],
    [34.785700, 2.808890],
    [34.838200, 1.848390],
    [34.812900, 1.241440],
    [35.885400, 0.774328],
    [35.805000, 1.872260],
    [36.012100, 2.869120],
    [35.878000, 3.973360],
    [35.774000, 5.114120],
    [35.795600, 5.812340],
    [35.766300, 7.105540],
    [35.880200, 7.873920],
    [36.245400, 8.881830],
    [35.767500, 9.894810],
    [36.983000, 9.795180],
    [37.295600, 8.925960],
    [36.973000, 7.777070],
    [37.277700, 7.085260],
    [37.051000, 5.781460],
    [36.856900, 4.886320],
    [36.764200, 3.772040],
    [36.804700, 3.158400],
    [36.883400, 1.844510],
    [37.106700, 0.878890],
    [37.833500, 0.805396],
    [37.813400, 1.857750],
    [38.232200, 2.762030],
    [37.829500, 3.888210],
    [37.775900, 4.837330],
    [37.845900, 5.864930],
    [37.868700, 6.777510],
    [37.882700, 7.821720],
    [37.895100, 8.820900],
    [38.164000, 10.133700],
    [39.252300, 9.885250],
    [39.247600, 9.225600],
    [38.883300, 7.831500],
    [38.874000, 6.817940],
    [38.887000, 5.997600],
    [38.813200, 4.800560],
    [38.805500, 3.887030],
    [38.794000, 2.770930],
    [38.789500, 1.793600],
    [38.863800, 0.841162],
    [39.813000, 0.779056],
    [39.846200, 1.837760],
    [39.826500, 3.150780],
    [39.814000, 3.828740],
    [39.811200, 4.774320],
    [39.885200, 5.864750],
    [39.919300, 6.843600],
    [39.876100, 8.212880],
    [39.859700, 9.189000],
    [39.885000, 9.767500],
    [40.896200, 9.875800],
    [40.868600, 8.806300],
    [40.888700, 7.764600],
    [40.861900, 6.817460],
    [40.861200, 5.818140],
    [40.797400, 4.814790],
    [40.779100, 4.271560],
    [40.863700, 2.773230],
    [40.822700, 1.828690],
    [40.799900, 0.839512],
    [41.802500, 1.151140],
    [41.896300, 1.806060],
    [42.261100, 2.837990],
    [41.840000, 3.844740],
    [41.798100, 5.103440],
    [41.892500, 5.877000],
    [41.938800, 6.845210],
    [42.037200, 7.773870],
    [41.800900, 8.812360],
    [41.998200, 9.984040],
    [42.793100, 9.806490],
    [42.844900, 8.848130],
    [42.894400, 7.827950],
    [42.778600, 6.883150],
    [42.809000, 5.870380],
    [42.773800, 4.802720],
    [43.295300, 3.805200],
    [42.876500, 2.892420],
    [42.844400, 1.761140],
    [42.764600, 1.255240],
    [43.793400, 0.933400],
    [43.845600, 1.894380],
    [43.877400, 3.294600],
    [43.787800, 4.046080],
    [43.795400, 4.820890],
    [43.878600, 5.879930],
    [43.882300, 7.117180],
    [43.827400, 8.105780],
    [44.121300, 8.857260],
    [43.845900, 9.844820],
    [44.760100, 9.816620],
    [45.186300, 8.844080],
    [44.895000, 8.182220],
    [44.774800, 6.811500],
    [44.807400, 5.806820],
    [44.767900, 5.230640],
    [44.872800, 4.246780],
    [44.851700, 2.819510],
    [44.795200, 2.081360],
    [44.832400, 0.873454],
    [46.297800, 0.783526],
    [45.787700, 1.904900],
    [45.866400, 2.763510],
    [45.842400, 3.838370],
    [45.834400, 4.870880],
    [45.825500, 5.784060],
    [45.775100, 6.883480],
    [45.817500, 7.814550],
    [45.778400, 8.767190],
    [45.842500, 10.255100],
    [46.889900, 9.880050],
    [46.768600, 8.867170],
    [46.799600, 7.870750],
    [46.866800, 6.775360],
    [46.818500, 5.786080],
    [46.807600, 5.125160],
    [46.805700, 3.896330],
    [47.134400, 3.068340],
    [46.806500, 1.829100],
    [46.870800, 0.854890],
    [48.083400, 0.875368],
    [47.793100, 1.881960],
    [47.888600, 3.009300],
    [47.760000, 4.121140],
    [47.873400, 4.864650],
    [48.031600, 5.869100],
    [47.777500, 6.793670],
    [47.992700, 7.888020],
    [47.859000, 8.833420],
    [47.804800, 9.865520],
    [48.896200, 9.815970],
    [48.894900, 8.833950],
    [48.793400, 7.771720],
    [48.857500, 6.881210],
    [48.804000, 5.803540],
    [48.776700, 4.853740],
    [48.798700, 3.823170],
    [48.894200, 2.785100],
    [48.860200, 1.909820],
    [48.828900, 1.119400],
    [49.803700, 0.852676],
    [49.795900, 2.089400],
    [49.776100, 2.858180],
    [50.206900, 4.294240],
    [49.875700, 4.824970],
    [50.279400, 5.869360],
    [49.784000, 6.844970],
    [49.870200, 7.810450],
    [49.889500, 8.814650],
    [49.867800, 9.767930],
    [50.779800, 9.852980],
    [50.775600, 8.855510],
    [50.832300, 7.844130],
    [50.803900, 6.785180],
    [50.766400, 5.856170],
    [50.766800, 5.052080],
    [50.820100, 4.161040],
    [50.838600, 2.793420],
    [50.829500, 1.913600],
    [50.816700, 0.775372],
    [51.803100, 0.837178],
    [51.800000, 2.135180],
    [51.843900, 2.798020],
    [51.842200, 3.881550],
    [51.812900, 4.846440],
    [52.006300, 5.853040],
    [51.892000, 6.854780],
    [51.863300, 7.837790],
    [51.760300, 8.834780],
    [51.881700, 9.835960],
    [52.821900, 9.818770],
    [52.789800, 8.826570],
    [52.869700, 7.762520],
    [52.847600, 6.998080],
    [52.852200, 5.844930],
    [52.794600, 4.793640],
    [52.939800, 3.867980],
    [52.789800, 2.764310],
    [52.888200, 2.156600],
    [52.781100, 0.820528],
    [53.995800, 0.891124],
    [53.816300, 1.861460],
    [53.835300, 2.790720],
    [53.778400, 4.051540],
    [53.792200, 4.894470],
    [53.878700, 6.199260],
    [53.852000, 6.788750],
    [53.800200, 8.000660],
    [53.891000, 9.024300],
    [53.790700, 9.890490],
    [54.831700, 10.007700],
    [54.827900, 8.825610],
    [54.849900, 7.948580],
    [54.764100, 6.870160],
    [55.275800, 5.895080],
    [54.884000, 5.208980],
    [54.828100, 3.782290],
    [54.886800, 2.770010],
    [54.983100, 2.170880],
    [54.826100, 0.832378],
    [55.790100, 1.054120],
    [55.943300, 1.788040],
    [55.827700, 2.853890],
    [55.780500, 4.142980],
    [55.855500, 4.885710],
    [55.813800, 5.886710],
    [55.821300, 6.891350],
    [56.169700, 7.839640],
    [56.050900, 8.811250],
    [56.114800, 9.858170],
    [56.866600, 9.821460],
    [56.843300, 9.231540],
    [56.799400, 8.228840],
    [56.882200, 6.807410],
    [56.906000, 5.879640],
    [56.876700, 4.781430],
    [56.864300, 3.862430],
    [56.928400, 2.873370],
    [56.880800, 1.813210],
    [56.793000, 1.016620],
    [57.805500, 0.868552],
    [57.847900, 1.778230],
    [58.206800, 2.783180],
    [57.855200, 3.761100],
    [57.849200, 5.202920],
    [57.919700, 5.777350],
    [57.864200, 6.826470],
    [57.766500, 7.864790],
    [58.201800, 8.845380],
    [57.941800, 9.864440],
    [58.795600, 9.801900],
    [58.880400, 8.781060],
    [58.860900, 7.803450],
    [58.766700, 6.787650],
    [58.880500, 5.766800],
    [58.783000, 4.781360],
    [58.768700, 3.965080],
    [58.805500, 2.876710],
    [58.869300, 2.236100],
    [59.195800, 0.865558],
    [59.808000, 0.761116],
    [59.883800, 2.020040],
    [60.098100, 2.767490],
    [59.768400, 3.883670],
    [60.161200, 4.851920],
    [59.793300, 5.887220],
    [59.771100, 6.808660],
    [59.867200, 7.790430],
    [60.248700, 8.878960],
    [60.000600, 9.761130],
    [60.856400, 9.925840],
    [60.776200, 8.843300],
    [61.054400, 7.778780],
    [60.777100, 6.762690],
    [60.848000, 5.861270],
    [60.893100, 4.795750],
    [61.192700, 3.872380],
    [60.796900, 2.881730],
    [60.982000, 1.802990],
    [60.815900, 0.761260],
    [61.785400, 0.810298],
    [61.924600, 1.877130],
    [61.888600, 2.849090],
    [62.202600, 3.956860],
    [61.847000, 4.825780],
    [61.861700, 5.882770],
    [61.787700, 6.792920],
    [61.877600, 7.870520],
    [61.768400, 8.870510],
    [61.835200, 9.858420],
    [62.827100, 9.876000],
    [62.845800, 9.112140],
    [63.133900, 7.956680],
    [62.799300, 6.851600],
    [63.099100, 5.802620],
    [63.294300, 4.799260],
    [62.798400, 3.798400],
    [62.826600, 2.890860],
    [62.830500, 2.152400],
    [62.894000, 0.853174],
    [63.780700, 0.780094],
    [63.802400, 1.769780],
    [63.880500, 2.801410],
    [63.879200, 3.873360],
    [63.862500, 4.885170],
    [63.836800, 5.855010],
    [63.893600, 6.868680],
    [63.837400, 7.848510],
    [63.793100, 9.251340],
    [63.817200, 9.851920],
    [64.883700, 10.105400],
    [64.956900, 8.863100],
    [64.844900, 8.165480],
    [64.869700, 6.843780],
    [65.030000, 5.816850],
    [64.847600, 4.806420],
    [64.913200, 3.884210],
    [64.764000, 2.826500],
    [64.782000, 1.872720],
    [64.849500, 0.892390],
    [66.187700, 0.821974],
    [65.817400, 1.892110],
    [65.824400, 2.818060],
    [65.784100, 3.827950],
    [65.833500, 4.811260],
    [66.286500, 5.798010],
    [65.794100, 6.891920],
    [65.947300, 7.775260],
    [65.902400, 8.979480],
    [65.878000, 9.765820],
    [66.840800, 9.865600],
    [66.894600, 8.765750],
    [66.767000, 7.893370],
    [67.136400, 6.797500],
    [67.298800, 5.842720],
    [67.100100, 4.985420],
    [66.876800, 4.272100],
    [66.793900, 2.771410],
    [67.258500, 1.807320],
    [66.878900, 1.100680],
    [68.022400, 1.206760],
    [67.796100, 1.891000],
    [68.243300, 2.849950],
    [67.846400, 3.783640],
    [68.119300, 4.821940],
    [67.859100, 5.881800],
    [67.820900, 7.016800],
    [67.896400, 7.868500],
    [68.213800, 8.765590],
    [67.897400, 9.863460],
    [68.893600, 9.848360],
    [68.779000, 8.995860],
    [68.842400, 7.773280],
    [68.764700, 7.131580],
    [68.772900, 5.827480],
    [68.804500, 4.798980],
    [68.879100, 3.829360],
    [69.077500, 2.840420],
    [68.881400, 2.250800],
    [68.867400, 0.792082],
    [69.766800, 0.908020],
    [69.802500, 1.841600],
    [69.842200, 3.235620],
    [69.772500, 3.815770],
    [69.834000, 4.858220],
    [69.849100, 5.866610],
    [69.793000, 7.078300],
    [69.881200, 7.807050],
    [69.763400, 8.762150],
    [69.800800, 9.896380],
    [70.794500, 9.777410],
    [70.869600, 8.782610],
    [70.809800, 7.896200],
    [70.892200, 7.144360],
    [71.034400, 5.850510],
    [70.840600, 4.898300],
    [70.780800, 3.827620],
    [70.875400, 2.880160],
    [71.109300, 1.883840],
    [70.888500, 0.855484],
    [71.833600, 1.183360],
    [71.876700, 2.167100],
    [72.207100, 2.856950],
    [71.844700, 3.829460],
    [71.886800, 4.818520],
    [71.788200, 5.865070],
    [71.770400, 6.857030],
    [71.852100, 7.819050],
    [71.779100, 8.886330],
    [71.810700, 10.265000],
    [72.882300, 9.798280],
    [72.943000, 9.018480],
    [72.911800, 7.895610],
    [72.833900, 6.801850],
    [72.777000, 5.878300],
    [72.814500, 4.799340],
    [72.807000, 3.805590],
    [72.958500, 2.783180],
    [72.786600, 1.869590],
    [73.140200, 0.818944],
    [73.802100, 0.846622],
    [74.156100, 1.809130],
    [73.877800, 2.780870],
    [74.090900, 3.796810],
    [73.777300, 4.817470],
    [73.895000, 5.888750],
    [74.207500, 7.264240],
    [73.862200, 7.828750],
    [73.774600, 8.783430],
    [73.808400, 9.963880],
    [74.847800, 9.803450],
    [74.825300, 8.809240],
    [74.874900, 7.815940],
    [74.891200, 6.908860],
    [75.020300, 6.106560],
    [75.036100, 5.246360],
    [74.817800, 4.268500],
    [75.079200, 2.826620],
    [75.044900, 1.761160],
    [74.773600, 1.279780],
    [75.974100, 0.793624],
    [76.266100, 1.815420],
    [75.775600, 2.840380],
    [75.826200, 3.771570],
    [75.781400, 4.879510],
    [75.845100, 6.296100],
    [75.881800, 7.282900],
    [75.793500, 7.807460],
    [75.806200, 8.768120],
    [75.865900, 10.232200],
    [76.842500, 10.061200],
    [76.851100, 8.769240],
    [76.781400, 7.858940],
    [76.765700, 6.854420],
    [76.775700, 5.913300],
    [76.841200, 4.864400],
    [76.877800, 3.782500],
    [77.235100, 2.855860],
    [76.834300, 1.876810],
    [76.770300, 0.868108],
    [77.831200, 0.802360],
    [77.842700, 1.866040],
    [77.837900, 2.884680],
    [77.841300, 3.869910],
    [77.815500, 4.853580],
    [77.845200, 6.056640],
    [77.814300, 6.833180],
    [77.820900, 8.258720],
    [77.866200, 8.878960],
    [77.819200, 9.884700],
    [78.877500, 9.885870],
    [78.807800, 8.780500],
    [78.819700, 7.854220],
    [78.846300, 6.794870],
    [78.835200, 5.796860],
    [79.237100, 4.793370],
    [78.768600, 3.791160],
    [78.874900, 2.868910],
    [79.264600, 1.764100],
    [78.777400, 0.832840],
    [79.853400, 0.876742],
    [79.876400, 1.775590],
    [79.767600, 2.902620],
    [79.840400, 3.761220],
    [79.784700, 5.157260],
    [80.037700, 5.768330],
    [80.198500, 6.797300],
    [79.820900, 7.809980],
    [79.863000, 9.140760],
    [79.777000, 9.865780],
    [80.872100, 9.832680],
    [80.888600, 8.769160],
    [80.763600, 7.857580],
    [80.868100, 6.843320],
    [80.917200, 5.883150],
    [80.883900, 4.882750],
    [80.802800, 3.844750],
    [80.789400, 2.839050],
    [80.853400, 1.780080],
    [80.793700, 0.789004],
    [81.771400, 0.787414],
    [82.237600, 1.804690],
    [81.935600, 2.889010],
    [81.770100, 4.264300],
    [81.856700, 4.879570],
    [81.858900, 5.767390],
    [81.843300, 7.010800],
    [81.884700, 7.777660],
    [81.923100, 8.847530],
    [81.860700, 9.930820],
    [82.878600, 9.774780],
    [83.060700, 8.769880],
    [82.872300, 7.770900],
    [82.856000, 7.208140],
    [82.860100, 5.833500],
    [82.841300, 4.799890],
    [82.796900, 4.185160],
    [82.817500, 3.286140],
    [82.766800, 1.857980],
    [82.770800, 1.138480],
    [83.779100, 0.785548],
    [83.797300, 1.843630],
    [83.820700, 3.065220],
    [83.763600, 4.280620],
    [83.876300, 5.216600],
    [83.872800, 5.890520],
    [83.968400, 6.832460],
    [83.775500, 7.791310],
    [83.809600, 8.871230],
    [83.870400, 9.784140],
    [84.803700, 9.884500],
    [84.830400, 8.815680],
    [84.764000, 7.772890],
    [84.815200, 6.843470],
    [84.878300, 5.933460],
    [84.773700, 4.850520],
    [85.073900, 3.779440],
    [84.868600, 2.772840],
    [84.877200, 1.804710],
    [85.041600, 0.803152],
    [85.799700, 0.774034],
    [85.792900, 1.800220],
    [86.227800, 2.767670],
    [86.073400, 3.807890],
    [85.884800, 4.778130],
    [85.805100, 5.874370],
    [86.004700, 7.200400],
    [85.884800, 7.791930],
    [86.171000, 8.813930],
    [85.859700, 10.080900],
    [86.891300, 9.871950],
    [86.881600, 8.817480],
    [86.771100, 7.791590],
    [87.111400, 6.812850],
    [86.878000, 5.799160],
    [86.861800, 4.766100],
    [86.785700, 3.814000],
    [87.165500, 3.184740],
    [86.764400, 1.789520],
    [86.829700, 0.834058],
    [87.803000, 0.899140],
    [87.810600, 1.815530],
    [87.877800, 2.883680],
    [87.814800, 3.872630],
    [87.780000, 4.831180],
    [87.819400, 5.766440],
    [87.866000, 6.833160],
    [88.252700, 8.059760],
    [87.852300, 9.284940],
    [87.851200, 9.883720],
    [88.890400, 9.884490],
    [88.886000, 8.850280],
    [88.863000, 7.787660],
    [89.227000, 6.890270],
    [88.761800, 5.818400],
    [89.209100, 4.841260],
    [88.814300, 4.044700],
    [88.822400, 2.850170],
    [88.873500, 1.783170],
    [88.772200, 1.123240],
    [89.886500, 0.790306],
    [89.846300, 1.879160],
    [89.893500, 2.776180],
    [89.852800, 3.850860],
    [89.885300, 4.819410],
    [89.830100, 5.895170],
    [89.903400, 7.098940],
    [89.872600, 7.822840],
    [89.796300, 8.860370],
    [89.870600, 9.846090],
    [91.004300, 9.879120],
    [90.868800, 9.279360],
    [90.870800, 7.865800],
    [91.276700, 6.882930],
    [91.166000, 5.823040],
    [90.987700, 5.064920],
    [90.853400, 3.859740],
    [90.877500, 2.830480],
    [90.935200, 1.778020],
    [90.795800, 0.774148],
    [91.771600, 0.965020],
    [91.880700, 1.877760],
    [91.839300, 3.088800],
    [91.892600, 3.801140],
    [91.872500, 4.810440],
    [91.831600, 5.881490],
    [91.847700, 6.777280],
    [91.844700, 7.862710],
    [91.879500, 8.770860],
    [91.816600, 9.873700],
    [92.996400, 10.108700],
    [93.028200, 9.243780],
    [92.835700, 7.820860],
    [92.831600, 6.807510],
    [92.838200, 5.823590],
    [92.875200, 4.861280],
    [92.873400, 3.827930],
    [92.794100, 2.907720],
    [92.867400, 1.769540],
    [93.234400, 0.859534],
    [93.910600, 0.815488],
    [94.116500, 1.975580],
    [93.790000, 3.045420],
    [93.813200, 3.801410],
    [93.772400, 4.955600],
    [93.761200, 5.837710],
    [94.161400, 6.771920],
    [93.849200, 7.848830],
    [93.937200, 8.854360],
    [93.805500, 9.800960],
    [94.894600, 9.805600],
    [94.872300, 8.834860],
    [94.889200, 7.888140],
    [95.063900, 6.761970],
    [94.823600, 5.824450],
    [94.931600, 4.832760],
    [94.887000, 3.862720],
    [94.885000, 2.760440],
    [94.854200, 1.779020],
    [94.791900, 0.766636],
    [95.807300, 0.933400],
    [95.768200, 1.845480],
    [95.837300, 2.862650],
    [95.894400, 3.833090],
    [96.038800, 5.239100],
    [95.877500, 5.821420],
    [95.888700, 6.912160],
    [95.844700, 7.767700],
    [95.781800, 8.874350],
    [95.854900, 9.804620],
    [97.274100, 9.804000],
    [97.265100, 8.791500],
    [96.864600, 8.188520],
    [97.109100, 6.821810],
    [96.778000, 5.873800],
    [96.878400, 4.814180],
    [96.781000, 4.219000],
    [96.772500, 2.826200],
    [96.867300, 1.867400],
    [96.764800, 0.870574],
    [97.818200, 0.825040],
    [97.843900, 0.081840],
]


def test_non_convex_polygon():
    polygon = [Point(x=x, y=y) for (x, y) in comb_coords]

    # inside the base of the comb
    assert point_in_polygon(Point(x=10, y=0.5), polygon)

    # just inside the first tooth
    assert point_in_polygon(Point(x=0.86, y=0.5), polygon)

    # just in between the first two teeth
    assert not point_in_polygon(Point(x=1.5, y=8), polygon)
